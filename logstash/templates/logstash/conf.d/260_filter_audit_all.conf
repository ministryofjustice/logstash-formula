
# auditd and apparmor via /var/log/audit.log
filter {
  if type == 'audit' {
    # If auditd is running apparmor will log to it.
    grok {
      patterns_dir => "/etc/logstash/patterns"
      match => [
                "message", "%{AUDIT}",
                "message", "%{AUDITLOGIN}",
                "message", "%{AUDITOTHER}",
                "message", "%{AUDIT_APPARMOR}"
               ]
    }
    kv {}
    if [audit_type] == "AVC" {
      mutate {
        replace => ["tags", "apparmor"]
      }
    }
  }
}
